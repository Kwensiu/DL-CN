{
    "version": "7.61.5.120",
    "description": "百度网盘 PC 版",
    "homepage": "https://pan.baidu.com/",
    "license": {
        "identifier": "Proprietary",
        "url": "https://pan.baidu.com/disk/duty/"
    },
    "architecture": {
        "64bit": {
            "url": "http://issuecdn.baidupcs.com/issue/netdisk/yunguanjia/BaiduNetdisk_7.61.5.120.exe#/dl.7z",
            "hash": "f564c9556164d3dfa0a14131a674155e5a211f51be18d6542f3b3ebc16defbe1"
        }
    },
    "shortcuts": [
        [
            "BaiduNetdisk.exe",
            "百度网盘"
        ]
    ],
    "persist": [
        "users",
        "BaiduNetdiskData",
        "baidunetdisk"
    ],
    "installer": {
        "script": [
            "Start-Process -Wait -FilePath \"$dir\\BaiduNetdisk_$version.exe\" -ArgumentList '/S'",
            "",
            "New-Item -ItemType Directory -Force -Path \"$persist_dir\\BaiduNetdiskData\" | Out-Null",
            "$baiduNetdiskPath = \"$persist_dir\\baidunetdisk\"",
            "New-Item -ItemType Directory -Force -Path $baiduNetdiskPath | Out-Null",
            "$subDirs = @(",
            "    'Code Cache\\js',",
            "    'Code Cache\\wasm',",
            "    'IndexedDB',",
            "    'Local Storage',",
            "    'Storage\\ext\\fake-host\\def',",
            "    'DawnCache',",
            "    'GPCuCache'",
            ")",
            "foreach ($subDir in $subDirs) {",
            "    New-Item -ItemType Directory -Force -Path \"$baiduNetdiskPath\\$subDir\" | Out-Null",
            "}",
            "$roamingPath = [Environment]::GetFolderPath('ApplicationData')",
            "$targetBaiduDir = \"$roamingPath\\baidunetdisk\"",
            "if (Test-Path $targetBaiduDir) {",
            "    Remove-Item $targetBaiduDir -Force -Recurse -ErrorAction SilentlyContinue",
            "}",
            "New-Item -ItemType Junction -Path $targetBaiduDir -Target $baiduNetdiskPath -Force | Out-Null"
        ]
    },
    "post_install": [
        "Remove-Item \"$dir\\BaiduNetdisk_*.exe\" -ErrorAction SilentlyContinue",
        "Remove-Item \"$dir\\`$PLUGINSDIR\" -Recurse -ErrorAction SilentlyContinue",
        "Remove-Item \"$dir\\`$TEMP\" -Recurse -ErrorAction SilentlyContinue"
    ],
    "pre_uninstall": [
        "$processName = \"YunDetectService\"",
        "if((Get-Process -Name $processName -ErrorAction SilentlyContinue) -eq $null) {",
        "Write-Host \"YunDetectService is not running.\" -ForegroundColor blue",
        "} else {",
        "Stop-Process -ProcessName $processName",
        "Write-Host \"YunDetectService is exist.\" -ForegroundColor green",
        "}"
    ],
    "post_uninstall": [
        "$roamingPath = [Environment]::GetFolderPath('ApplicationData')",
        "$baiduDirs = @(",
        "    \"$roamingPath\\baidunetdisk\",",
        "    \"$env:APPDATA\\BaiduYunGuanjia\",",
        "    \"$env:APPDATA\\BaiduYunKernel\",",
        "    \"$env:LOCALAPPDATA\\BaiduYunKernel\"",
        ")",
        "foreach ($dirPath in $baiduDirs) {",
        "    if (Test-Path \"$dirPath\") {",
        "        Remove-Item \"$dirPath\" -Force -Recurse -ErrorAction SilentlyContinue",
        "    }",
        "}"
    ],
    "checkver": {
        "url": "https://pan.baidu.com/disk/cmsdata?do=client",
        "jsonpath": "$.guanjia.url",
        "regex": "BaiduNetdisk_([\\d.]+).exe"
    },
    "autoupdate": {
        "url": "http://issuecdn.baidupcs.com/issue/netdisk/yunguanjia/BaiduNetdisk_$version.exe#/dl.7z"
    }
}
